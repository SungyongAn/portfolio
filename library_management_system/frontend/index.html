<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>図書館システム</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
    <div id="app">
        <main class="d-flex flex-nowrap min-vh-100">
            <!-- サイドメニューコンポーネント -->
            <side-menu 
                :current-page="currentPage"
                :is-logged-in="isLoggedIn"
                :current-user="currentUser"
                @page-change="setCurrentPage"
                @logout="logout">
            </side-menu>
            
            <!-- メインコンテンツ -->
            <div class="main p-4 flex-grow-1">
                <!-- TOPページコンポーネント -->
                <top-page 
                    v-if="currentPage === 'top'"
                    :is-logged-in="isLoggedIn"
                    :current-user="currentUser">
                </top-page>
                
                <!-- ログインコンポーネント -->
                <login-form 
                    v-if="currentPage === 'login'"
                    :login-form="loginForm"
                    :is-loading="isLoading"
                    :login-error="loginError"
                    :login-success="loginSuccess"
                    :show-password="showPassword"
                    @login="handleLogin"
                    @toggle-password="showPassword = !showPassword"
                    @page-change="setCurrentPage">
                </login-form>
                
                <!-- 初回認証コンポーネント -->
                <first-auth-form 
                    v-if="currentPage === 'firstAuth'"
                    :first-auth-form="firstAuthForm"
                    @first-auth="handleFirstAuth"
                    @page-change="setCurrentPage">
                </first-auth-form>
                
                <!-- パスワード登録コンポーネント -->
                <set-password-form 
                    v-if="currentPage === 'setPassword'"
                    :password-form="passwordForm"
                    :verified-user="verifiedUser"
                    :show-new-password="showNewPassword"
                    :show-confirm-password="showConfirmPassword"
                    @set-password="handleSetPassword"
                    @toggle-new-password="showNewPassword = !showNewPassword"
                    @toggle-confirm-password="showConfirmPassword = !showConfirmPassword"
                    @page-change="setCurrentPage">
                </set-password-form>
            </div>
        </main>
    </div>

    <!-- コンポーネントファイルの読み込み -->
    <script src="components/SideMenu.js"></script>
    <script src="components/TopPage.js"></script>
    <script src="components/LoginForm.js"></script>
    <script src="components/FirstAuth.js"></script>
    <script src="components/SetPasswordForm.js"></script>
    
    <script src="app.js"></script>
</body>
</html>
